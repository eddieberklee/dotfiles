# Split panes with \ (left/right) and - (top/bottom), keeping the same working dir
unbind '%'
unbind '"'
bind \\ split-window -h -c "#{pane_current_path}"
bind -  split-window -v -c "#{pane_current_path}"

# Enable mouse for pane resizing (click and drag borders)
set -g mouse on

# Switch panes with Prefix + h/j/k/l
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Swap (move) panes with Prefix + H/J/K/L
bind H swap-pane -s '{left-of}'
bind J swap-pane -s '{down-of}'
bind K swap-pane -s '{up-of}'
bind L swap-pane -s '{right-of}'

# Pane backgrounds: fade inactive panes slightly
set -g window-style 'fg=colour243,bg=colour235'
set -g window-active-style 'bg=terminal'

# Distinct active pane border
set -g pane-active-border-style fg=colour39,bg=colour240
set -g pane-border-style fg=colour243,bg=colour240
set -g pane-border-lines simple
# Pane border labels: always on
# Shows pane_title if set (by Claude hook or Prefix+.), otherwise shows command + path
set -g pane-border-status top
set -g pane-border-format " #[bold,fg=colour255]#{pane_index}  #{pane_title}  #{pane_current_command}  #{s|$HOME|~|:pane_current_path}#[nobold] "

# Rename pane with Prefix + . (set a custom title)
bind . command-prompt -p "Pane title:" 'select-pane -T "%%"'
# Reset pane title back to default with Prefix + >
bind > run-shell 'tmux select-pane -T "#{host_short}"'

# Status bar styling
set -g status-style fg=colour250,bg=colour235
set -g status-justify left
set -g status-left "     "

# Inactive windows: subdued
set -g window-status-format " #I: #W "
set -g window-status-style fg=colour244,bg=colour235

# Active window: bright highlight
set -g window-status-current-format " #I: #W "
set -g window-status-current-style fg=colour232,bg=colour39,bold

# Bell monitoring: highlight window tab when a bell is received
setw -g monitor-bell on
set -g window-status-bell-style fg=colour232,bg=colour226,bold

# --- Claude Code / rendering stability ---
# Reduce escape sequence delay (prevents rendering lag)
set -sg escape-time 0
# Enable focus events (helps apps detect pane focus properly)
set -g focus-events on
# Don't let programs rename windows (prevents Claude overwriting names)
set -g allow-rename off
# Prevent activity in other panes from triggering alerts/focus changes
setw -g monitor-activity off
set -g visual-activity off

# --- Plugins ---
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# --- Continuum settings ---
# Auto-save every 15 minutes
set -g @continuum-save-interval '15'
# Automatically restore last saved session when tmux server starts
set -g @continuum-restore 'on'

# --- Resurrect settings ---
# Restore pane contents
set -g @resurrect-capture-pane-contents 'on'

# Initialize TPM (keep this at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
